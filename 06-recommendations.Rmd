# Moving forward: short-term accommodation regulation pathways in Prince Edward County

<style type="text/css">
  body{
  font-family: Futura, Helvetica, Arial;
}
</style>

<br>

```{r setup, include = FALSE, echo = FALSE}

library(here)
source(here("R", "01_startup.R"))

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)

# Function for checking file modifications
mtime <- function(files) lapply(Sys.glob(files), function(x) file.info(x)$mtime)

# Set this to TRUE to output PDF figures
build_figures <- TRUE

qload(here("output", "/geometry.qsm"))
qload(here("output", "/str_processed.qsm"))
rent_sept <- qread("output/rent_sept.qs")

options(tinytex.verbose = TRUE)

```

```{r new_objects}

```

```{r exec_summ}


```

**TKTK**

<br>

The previous chapters show that the housing situation in Prince Edward County has changed drastically since the start of the Covid-19 pandemic. In the county, Covid is the principal driver of the current housing challenges. The pandemic caused STA accommodations to decline in quantity but drastically increase the nightly prices, making for highly profitable operations for the listings still active. The number and sale prices of homes have also skyrocketed, namely due to a booming remote work-induced demand for homes out of city centers and secondary homes purchases. Both the short-term accommodation and secondary home market act as a single market applying pressure to Prince Edward County's housing stock. In addition, the low influx of new construction causes increased pressure on the existing stock, calling for more locally-oriented housing units. This chapter provides regulatory pathways for the reinstatement of a STA registration system, in light of the county's need for a healthy housing market for residents.

## Regulatory priorities

In light of our analysis, two priorities emerged for the reinstating of a short-term accommodation registration system in Prince Edward County. First, the STA registration system needs to be able to differentiate STAs operated out of primary and secondary residences, and prioritize owner occupied STAs. There have been numerous studies that have showed that the trade-off between STAs and housing affordability is largest with dedicated, or full-time commercial, STAs (Wachsmuth et al 2021; Garcia-López et al. 2019, Wachsmuth & Weisler 2018; Horn & Merante 2017). Other detrimental effects of dedicated STAs in cities include noise, littering and overcrowding (Celata and Romano 2020; Nieuwland and van Melik 2020). STA activity in the county should thus be redirected to owner-occupied, "homesharing" STAs to minimize the negative externalities of the short-term market. Second, a successful STA registration system in the county should aim to reduce to the minimum or potentially eliminate grandfathering of STAs. Indeed, any change to the STA legal landscape will enormously benefit current STA operators, ultimately reducing the efficacy of the rules. Given the market conditions of present STAs, any unit which would not be subject to stricter rules would be in an advantageous position once the updated regulations come into effect. 

Based on our findings and established priorities, we modeled four potential scenarios based on two sets of conditions. Prince Edward could either Redistribute or Restrict, and do so either in the townships only, or in the towns and townships (in the entire county). 

The "Redistribute" route would promote home-sharing in Prince Edward County by removing dedicated STAs and redistribute STA activity more broadly in the hands of more county households. The aim is to grow the size of the STA market in terms of operating accommodations, but to minimize the negative housing impacts associated with full time operations. The county would grant unlimited STA licenses, both only for a host's principal residence. This way, total STA revenues would be redistributed among Prince Edward County families, with local firms providing intermediary services such as property management.

The "Restrict" route would control the number of STAs in Prince Edward County by restricting the number of STA licenses being granted, but still allowing commercial operations. Restricting the number of licenses would shrink the STA market in order to shrink the negative housing impacts, concentrating STA activity in fewer and bigger operations. The "Restrict" models would use high license fees to ensure that licenses are used by hosts willing to operate at a high frequency, thereby ensuring an active STA market to address tourist demand. 

## Redistribute

Open the flood gate return to previous 2019 option, leading to X new STR. The price would go down, but what gives! They would allow it, punto.

## Regulation option 2

They want it to be a business license. They want to be able to put conditions on STR, which is different if it’s just zoning. Context of regulation: vast demand from outside of town. Try to shift STR to owner-occupied. Vast incentive for locals to leave the summer and rent STR for the summer. Get the vast demand in places where they operate sporadically. Very strict no secondary home STR. These business permits are only open for residents. If your legal residence isn’t that home, then you’re not allowed. Creating incentives for local to rent their place in summer. __Maybe different geographically: towns (principal residents) vs countryside (run wild).__

## Regulation option 3
Only able to get a business licence for principal residents all over. Grand fathering for people that already have a license for their second residence. 


## Short-term incentive program

```{r short_term_incentive}

num_bedrooms <- 
  property %>% 
  st_drop_geometry() %>% 
  mutate(bedrooms = if_else(bedrooms >= 3, 3, bedrooms)) %>% 
  select(property_ID, bedrooms)

FREH_properties <- 
  daily %>% 
  filter(FREH_6) %>% 
  distinct(property_ID) %>% 
  pull()

LTM_revenue <- 
  daily %>% 
  left_join(num_bedrooms) %>% 
  filter(date >= max(daily$date) - years(1), status == "R", listing_type == "Entire home/apt",
         property_ID %in% FREH_properties) %>%
  mutate(ward = if_else(!ward %in% c("Picton", "Wellington", "Bloomfield"), 
                        "Township", ward)) %>% 
  group_by(property_ID, ward, bedrooms) %>% 
  summarize(rev_LTM = sum(price)) %>% 
  ungroup()
  
avg_rent <- 
rent_sept %>% 
  group_by(ward) %>% 
  summarize(rent = mean(rent))

rev_to_weight_mean <- 
  LTM_revenue %>% 
  group_by(bedrooms) %>% 
  summarize(monthly_rev_LTM = mean(rev_LTM) / 12,
            weight = n())

rent_to_weight_mean <- 
  rent_sept %>% 
  group_by(bedrooms) %>% 
  summarize(monthly_rent = mean(rent),
            weight = n())

avg_monthly_rev_LTM <- 
weighted.mean(rev_to_weight_mean$monthly_rev_LTM,
              rent_to_weight_mean$weight) %>% 
  round(-1) %>% 
  scales::dollar()

avg_monthly_rent <- 
weighted.mean(rent_to_weight_mean$monthly_rent,
              rent_to_weight_mean$weight) %>% 
  round(-1) %>% 
  scales::dollar()

var_rev_rent <- 
{(weighted.mean(rev_to_weight_mean$monthly_rev_LTM,
              rent_to_weight_mean$weight) - 
weighted.mean(rent_to_weight_mean$monthly_rent,
              rent_to_weight_mean$weight)) /
weighted.mean(rent_to_weight_mean$monthly_rent,
              rent_to_weight_mean$weight)} %>% 
  scales::percent()


```

Prior to changing regulations, PEC might be interested in a short-term incentive program to bring short-term rentals back to the longer-term market. A financial incentive can be given to STR hosts to change the market on which their housing units operate. We looked at how much a commercial STR made monthly in the last twelve months, compared to rent data in September 2021. As 3+ bedrooms units are over-represented on the STR, we looked at the weighted average of monthly STR revenue and rent. Commercial listings made a weighted average of `r avg_monthly_rev_LTM` a month, while the weighted average monthly rent was of `r avg_monthly_rent` in September. It represents a difference of `r var_rev_rent`.

```{r on_water, cache = TRUE, cache.lazy = FALSE}

qload(here("output", "geometry.qsm"), nthreads = availableCores())

ocean <-
  read_sf(here("data", "shapefiles", "lhy_000h16a_e.shp")) %>%
  st_transform(32618)

ocean <-
  ocean %>%
  st_filter(select(city, -everything()))

river <-
  read_sf(here("data", "shapefiles", "lhy_000c16a_e.shp")) %>%
  st_transform(32618)

river <-
  river %>%
  st_filter(select(city, -everything()))

water <- rbind(select(river, -everything()), select(ocean, -everything()))

rm(ocean, river, city)
```

``` {r make_fig_6_1}

weight_rent_sept <- 
rent_sept %>% 
  group_by(ward, bedrooms)  %>% 
  summarize(mean_rent = mean(rent),
            weight = n())

weight_revenue_ward <- 
LTM_revenue %>% 
  group_by(ward, bedrooms) %>% 
  summarize(mean_rev = mean(rev_LTM) / 12,
            weight = n())

# Weighted average to compare with rents, weight of STRs
LTM_revenue_ward <- 
tibble(ward = c("Bloomfield", "Wellington", "Township", "Picton"), mean_rev = c(weighted.mean(weight_revenue_ward[weight_revenue_ward$ward == "Bloomfield",]$mean_rev,
weight_revenue_ward[weight_revenue_ward$ward == "Bloomfield",]$weight),

weighted.mean(weight_revenue_ward[weight_revenue_ward$ward == "Wellington",]$mean_rev,
weight_revenue_ward[weight_revenue_ward$ward == "Wellington",]$weight),

weighted.mean(weight_revenue_ward[weight_revenue_ward$ward == "Township",]$mean_rev,
weight_revenue_ward[weight_revenue_ward$ward == "Township",]$weight),

weighted.mean(weight_revenue_ward[weight_revenue_ward$ward == "Picton",]$mean_rev,
weight_revenue_ward[weight_revenue_ward$ward == "Picton",]$weight)))

# Weight average to compare with revenue, weight of STRs
set_rent_ward <- 
tibble(ward = c("Bloomfield", "Wellington", "Township", "Picton"), mean_rent = c(weighted.mean(weight_rent_sept[weight_rent_sept$ward == "Bloomfield",]$mean_rent,
weight_revenue_ward[weight_revenue_ward$ward == "Bloomfield",]$weight),

weighted.mean(weight_rent_sept[weight_rent_sept$ward == "Wellington",]$mean_rent,
weight_revenue_ward[weight_revenue_ward$ward == "Wellington",]$weight),

weighted.mean(weight_rent_sept[weight_rent_sept$ward == "Township",]$mean_rent,
weight_revenue_ward[weight_revenue_ward$ward == "Township",]$weight),

weighted.mean(weight_rent_sept[weight_rent_sept$ward == "Picton",]$mean_rent,
weight_revenue_ward[weight_revenue_ward$ward == "Picton",]$weight)))

rent_wards <- 
EW %>% 
  mutate(ward = if_else(type == "Township", "Township", ward)) %>%
  group_by(ward) %>% 
  summarize() %>% 
  left_join(set_rent_ward)

surplus_rent <- 
LTM_revenue_ward %>% 
  left_join(rent_wards) %>% 
  mutate(surplus = round(mean_rev - mean_rent, -1)) %>% 
  st_as_sf()

street <- qread("output/street.qs")

figure_6_1_fun <- function(regular = "", condensed = "") {
  
townships <- 
surplus_rent[surplus_rent$ward == "Township",] %>% 
  ggplot() +
  geom_sf(data = province, colour = "transparent", fill = "grey93") +
  geom_sf(
    aes(fill = surplus),
    lwd = 0,
    colour = "white"
  ) +
  geom_sf(data = street, colour = "white", alpha = 0.2) +
  geom_sf(data = water, fill = "white", colour = "transparent") +
  scale_fill_stepsn(
    name = "Monthly dif. btw avg. rent\nand avg. full-time STA revenue",
    colors = col_palette[c(5, 3, 4, 6)], 
                       na.value = "grey80",
                       limits = c(min(surplus_rent$surplus), 
                                  max(surplus_rent$surplus)),
                       oob = scales::squish, 
                       labels = scales::dollar)+
  gg_bbox(surplus_rent)+
  theme_void() +
  theme(
    legend.position = "bottom",
    legend.key.width= unit(1.5, 'cm')
  )+
  geom_sf_label(aes(label = scales::dollar(round(surplus))),
                nudge_y = 5000, nudge_x = -5000)+
  ggtitle("Townships")

picton <- 
  surplus_rent[surplus_rent$ward == "Picton",] %>% 
  ggplot() +
  # geom_sf(data = province, colour = "transparent", fill = "grey93") +
  geom_sf(
    aes(fill = surplus),
    lwd = 0,
    colour = "white"
  ) +
  geom_sf(data = street, colour = "white", alpha = 0.2) +
  geom_sf(data = water, fill = "white", colour = "transparent") +
  scale_fill_stepsn(
    name = "Monthly dif. btw avg. rent\nand avg. full-time STA revenue",
    colors = col_palette[c(5, 3, 4, 6)], 
                       na.value = "grey80",
                       limits = c(min(surplus_rent$surplus), 
                                  max(surplus_rent$surplus)),
                       oob = scales::squish, 
                       labels = scales::dollar)+
  gg_bbox(surplus_rent[surplus_rent$ward == "Picton",])+
  theme_void() +
  theme(
    legend.position = "bottom",
    legend.key.width= unit(1.5, 'cm')
  )+
  geom_sf_label(aes(label = scales::dollar(round(surplus))))+
  ggtitle("Picton")

bloomfield <- 
  surplus_rent[surplus_rent$ward == "Bloomfield",] %>% 
  ggplot() +
  # geom_sf(data = province, colour = "transparent", fill = "grey93") +
  geom_sf(
    aes(fill = surplus),
    lwd = 0,
    colour = "white"
  ) +
  geom_sf(data = street, colour = "white", alpha = 0.2) +
  geom_sf(data = water, fill = "white", colour = "transparent") +
  scale_fill_stepsn(
    name = "Monthly dif. btw avg. rent\nand avg. full-time STA revenue",
    colors = col_palette[c(5, 3, 4, 6)], 
                       na.value = "grey80",
                       limits = c(min(surplus_rent$surplus), 
                                  max(surplus_rent$surplus)),
                       oob = scales::squish, 
                       labels = scales::dollar)+
  gg_bbox(surplus_rent[surplus_rent$ward == "Bloomfield",])+
  theme_void() +
  theme(
    legend.position = "bottom",
    legend.key.width= unit(1.5, 'cm')
  )+
  geom_sf_label(aes(label = scales::dollar(round(surplus))))+
  ggtitle("Bloomfield")

wellington <- 
  surplus_rent[surplus_rent$ward == "Wellington",] %>% 
  ggplot() +
  # geom_sf(data = province, colour = "transparent", fill = "grey93") +
  geom_sf(
    aes(fill = surplus),
    lwd = 0,
    colour = "white"
  ) +
  geom_sf(data = street, colour = "white", alpha = 0.2) +
  geom_sf(data = water, fill = "white", colour = "transparent") +
  scale_fill_stepsn(
    name = "Monthly dif. btw avg. rent\nand avg. full-time STA revenue",
    colors = col_palette[c(5, 3, 4, 6)], 
                       na.value = "grey80",
                       limits = c(min(surplus_rent$surplus), 
                                  max(surplus_rent$surplus)),
                       oob = scales::squish, 
                       labels = scales::dollar)+
  gg_bbox(surplus_rent[surplus_rent$ward == "Wellington",])+
  theme_void() +
  theme(
    legend.position = "bottom",
    legend.key.width= unit(1.5, 'cm')
  )+
  geom_sf_label(aes(label = scales::dollar(round(surplus))))+
  ggtitle("Wellington")



library(patchwork)

combined <- 
(townships + picton) / (bloomfield + wellington) & 
  theme(legend.position = "bottom")

combined + plot_layout(guides = "collect")

}

if (build_figures) {
  ggsave(here("output", "figures", "figure_6_1.pdf"), 
         plot = figure_6_1_fun("Futura", "Futura Condensed"), 
         width = 8, height = 5, units = "in", useDingbats = FALSE)
  
  extrafont::embed_fonts(here("output", "figures", "figure_6_1.pdf"))
}

```

``` {r fig-6-1, include = TRUE, fig.cap = '(ref:fig-6-1)', fig.align = "center"}

figure_6_1_fun()

```

(ref:fig-6-1) _Average amount of monthly subsidy necessary to turn a STR to the LTR market_

``` {r short_term_incentive_2}

subisdy_outside_wellington <- 
surplus_rent %>% 
  st_drop_geometry() %>% 
  filter(ward != "Wellington") %>% 
  summarize(mean(surplus)) %>% 
  pull() %>% 
  round(-1) %>% 
  scales::dollar()

subisdy_wellington <- 
surplus_rent %>% 
  st_drop_geometry() %>% 
  filter(ward == "Wellington") %>% 
  summarize(mean(surplus)) %>% 
  pull() %>% 
  round(-1) %>% 
  scales::dollar()

```

While rents are similar across the county, monthly revenue in STR differ from a location to another. In fact, the great difference only occurs in Wellington.
Figure \@ref(fig:fig-6-1) shows the average amount of monthly subsidy that would be necessary to turn a STR to the LTR market. On average, this short-term incentive program would cost the county `r subisdy_wellington` per unit in Wellington, and `r subisdy_outside_wellington` in the rest of the county. It does not make it much of a viable solution.

\newpage
